pipeline {
    agent any
    environment {
        BROWSERSTACK_USERNAME = 'rodrigomontemor_unN8kU'
        BROWSERSTACK_ACCESS_KEY = 'oLhAq8Y8MFWzq4irqZJE'
    }
    stages {
        stage('setup') {
            steps {
                script {
                    // Configure BrowserStack credentials
                    withCredentials([usernamePassword(credentialsId: 'browserstack-credentials', usernameVariable: 'BROWSERSTACK_USERNAME', passwordVariable: 'BROWSERSTACK_ACCESS_KEY')]) {
                        // Execute os testes usando as ferramentas do BrowserStack
                        sh 'npm i'
                        sh 'npx playwright test --browser=firefox@latest --browserstack'
                    }
                }
            }
        }
    }
}
